steps:

  - task: PowerShell@2
    displayName: 'Cake MergeCoverageFiles'
    inputs:
      filePath: 'starsky/build.ps1'
      arguments: '${{ parameters.runtimeArg }} -target="MergeCoverageFiles"'
      pwsh: true
      workingDirectory: '$(Build.SourcesDirectory)/starsky/'

  - task: PowerShell@2
    displayName: 'Cake CoverageReport'
    inputs:
      filePath: 'starsky/build.ps1'
      arguments: '${{ parameters.runtimeArg }} -target="CoverageReport"'
      pwsh: true
      workingDirectory: '$(Build.SourcesDirectory)/starsky/'

  - task: PublishCodeCoverageResults@1
    displayName: 'Publish code coverage from $(Build.SourcesDirectory)\starsky\starskytest\coverage-merge-cobertura.xml'
    inputs:
      codeCoverageTool: Cobertura
      summaryFileLocation: '$(Build.SourcesDirectory)\starsky\starskytest\coverage-merge-cobertura.xml'