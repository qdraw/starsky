@using Microsoft.AspNetCore.Mvc
@using starsky.ViewModels
@model IndexViewModel
@{
    ViewData["Title"] = Model.SearchQuery + " Index view ";
}

<h2>

    @foreach (var item in Model.Breadcrumb)
    {
        var name = @item.Split("/")[item.Split("/").Length - 1];
        if (name == "")
        {
            name = "Home";
        }
        <a asp-controller="Home" asp-action="Index" asp-route-f="@item">@name</a>
        if (item != Model.Breadcrumb[Model.Breadcrumb.Count - 1])
        {
            <span> &raquo;</span>
        }
    }
</h2>

<div class="wrapper">
    @foreach (var item in Model.FileIndexItems)
    {

        <a class="halfitem" asp-controller="Home" asp-action="Index" asp-route-f="@item.FilePath">
            <div class="caption">
                <h3>@item.FileName</h3>
                <p>@item.Tags&nbsp;</p>
            </div>

            @if (!@item.IsDirectory)
            {
                <img class="lazyload" src="#" data-src="@Url.Action("Thumbnail", "Api", new {f = item.FileHash})" alt="" />
            }
            else
            {
                <img src="#" alt="" />
            }
        </a>
    }
</div>

<script type="text/javascript">
    var allItems =   document.querySelectorAll(".halfitem .caption h3");
    for(var i = 0; i < allItems.length; i++) {
        document.querySelectorAll(".halfitem .caption h3")[i].innerHTML = allItems[i].innerHTML.replace(".jpg","");
    }
    console.log();
</script>
