@using System.Linq
@using System.Globalization;
@model starsky.feature.webhtmlpublish.ViewModels.WebHtmlViewModel

<!doctype html>
<html lang="nl">
<head>
    <meta charset="utf-8">
    <title>@Model.ItemName</title>
    <meta name="generator" content="@Model.AppSettings.Name">
</head>
<body>
    <div style="width:500px; margin: 0 auto 0 auto;">

		@{
			var profile500 = Model.Profiles
				.FirstOrDefault(p => p.SourceMaxWidth == 500);
	        var fileFolder500 = profile500?.Folder ?? "500/";
	        var append500 = profile500?.Append ?? string.Empty;
	        var profile1000 = Model.Profiles
		        .FirstOrDefault(p => p.SourceMaxWidth == 1000);
	        var fileFolder1000 = profile1000?.Folder ?? "1000/";
	        var append1000 = profile1000?.Append ?? string.Empty;
	    }


	    @for (int i = 0; i < @Model.FileIndexItems.Count(); i++)
	    {
	        var item = @Model.FileIndexItems[i];
	        var count = i + 1;
	        var heightRatio = Math.Round((double)@item.ImageHeight / @item.ImageWidth, 3)
		        .ToString(CultureInfo.InvariantCulture); ;
	        var latitude = Math.Round(@item.Latitude, 6).ToString(CultureInfo.InvariantCulture);
	        var longitude = Math.Round(@item.Longitude, 6).ToString(CultureInfo.InvariantCulture);

	        //    // Logic to setup filename
		    var filePath500 = @Model.AppSettings.GetWebSafeReplacedName(
			    @Model.CurrentProfile.Prepend, @Model.ItemName) + @fileFolder500 + 
		                      @item.FileCollectionName + @append500 + @System.IO.Path.GetExtension(item.FileName);
		    var filePath1000 = @Model.AppSettings.GetWebSafeReplacedName(
			    @Model.CurrentProfile.Prepend, @Model.ItemName) + @fileFolder1000 + 
		                       @item.FileCollectionName + @append1000 + @System.IO.Path.GetExtension(item.FileName);

	        var displayTitleName = !string.IsNullOrEmpty(@item.Title) ? @item.Title : @Model.ItemName;

			<a href="@filePath1000" class="lightbox[blog]"
	           title="@Model.ItemName - @item.Title | foto @count"
	           data-gps="@latitude,@longitude" data-heightratio="@heightRatio">
	            <noscript><img src="@filePath500" alt=" @item.Title" /></noscript>
				<img src="@Model.Base64ImageArray[i]" title="@displayTitleName | foto @count" 
				     alt="@Model.ItemName ; @item.Title ; @item.Tags" />
	        </a>
		}

    </div>
    <script src="_bigimages-helper.js" type="text/javascript"></script>

</body>
</html>


